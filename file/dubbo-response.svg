<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="2532" height="879" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[Title: Dubbo协议+Netty4传输，服务响应过程
NettyServer-->NettyHandler: messageReceived
NettyHandler->AbstractPeer: received
AbstractPeer->MultiMessageHandler: received
MultiMessageHandler->HeartbeatHandler: received
HeartbeatHandler->AllChannelHandler: received
AllChannelHandler-->ChannelEventRunnable: run
Note over AllChannelHandler: 默认线程池\nWrappedChannelHandler.SHARED_EXECUTOR
ChannelEventRunnable->DecodeHandler: received
DecodeHandler->HeaderExchangeHandler: received
HeaderExchangeHandler->DubboProtocol.requestHandler: reply
DubboProtocol.requestHandler->DubboProtocol: getInvoker
Note over DubboProtocol:exporterMap中缓存了以\n“test.dubbo.demo.ISayHi:20880”\n-Exporter的映射关系
DubboProtocol.requestHandler->ProtocolFilterWrapper.Invoker: invoke
Note over ProtocolFilterWrapper.Invoker: EchoFilter-ClassLoaderFilter\n-GenericFilter-ContextFilter\n-TraceFilter-TimeoutFilter\n-MonitorFilter-ExceptionFilter
ProtocolFilterWrapper.Invoker->AbstractProxyInvoker: invoke
HeaderExchangeHandler->NettyChannel: send
]]></source><desc>Dubbo协议+Netty4传输，服务响应过程</desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"><rect x="10" y="10" width="282" height="26" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="15" y="29" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">Dubbo协议+Netty4传输，服务响应过程</tspan></text></g><g class="actor"><rect x="10" y="46" width="108" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="20" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="20">NettyServer</tspan></text></g><g class="actor"><rect x="10" y="823.171875" width="108" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="20" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="20">NettyServer</tspan></text></g><line x1="64" x2="64" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="146" y="46" width="116" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="156" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="156">NettyHandler</tspan></text></g><g class="actor"><rect x="146" y="823.171875" width="116" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="156" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="156">NettyHandler</tspan></text></g><line x1="204" x2="204" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="282" y="46" width="116" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="292" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="292">AbstractPeer</tspan></text></g><g class="actor"><rect x="282" y="823.171875" width="116" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="292" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="292">AbstractPeer</tspan></text></g><line x1="340" x2="340" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="418" y="46" width="172" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="428" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="428">MultiMessageHandler</tspan></text></g><g class="actor"><rect x="418" y="823.171875" width="172" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="428" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="428">MultiMessageHandler</tspan></text></g><line x1="504" x2="504" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="610" y="46" width="148" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="620" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="620">HeartbeatHandler</tspan></text></g><g class="actor"><rect x="610" y="823.171875" width="148" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="620" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="620">HeartbeatHandler</tspan></text></g><line x1="684" x2="684" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="778" y="46" width="156" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="788" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="788">AllChannelHandler</tspan></text></g><g class="actor"><rect x="778" y="823.171875" width="156" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="788" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="788">AllChannelHandler</tspan></text></g><line x1="856" x2="856" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="954" y="46" width="180" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="964" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="964">ChannelEventRunnable</tspan></text></g><g class="actor"><rect x="954" y="823.171875" width="180" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="964" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="964">ChannelEventRunnable</tspan></text></g><line x1="1044" x2="1044" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="1154" y="46" width="124" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1164" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1164">DecodeHandler</tspan></text></g><g class="actor"><rect x="1154" y="823.171875" width="124" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1164" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1164">DecodeHandler</tspan></text></g><line x1="1216" x2="1216" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="1298" y="46" width="188" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1308" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1308">HeaderExchangeHandler</tspan></text></g><g class="actor"><rect x="1298" y="823.171875" width="188" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1308" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1308">HeaderExchangeHandler</tspan></text></g><line x1="1392" x2="1392" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="1506" y="46" width="244" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1516" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1516">DubboProtocol.requestHandler</tspan></text></g><g class="actor"><rect x="1506" y="823.171875" width="244" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1516" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1516">DubboProtocol.requestHandler</tspan></text></g><line x1="1628" x2="1628" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="1770" y="46" width="124" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1780" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1780">DubboProtocol</tspan></text></g><g class="actor"><rect x="1770" y="823.171875" width="124" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1780" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1780">DubboProtocol</tspan></text></g><line x1="1832" x2="1832" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="1914" y="46" width="252" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1924" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1924">ProtocolFilterWrapper.Invoker</tspan></text></g><g class="actor"><rect x="1914" y="823.171875" width="252" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1924" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1924">ProtocolFilterWrapper.Invoker</tspan></text></g><line x1="2040" x2="2040" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="2186" y="46" width="180" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="2196" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="2196">AbstractProxyInvoker</tspan></text></g><g class="actor"><rect x="2186" y="823.171875" width="180" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="2196" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="2196">AbstractProxyInvoker</tspan></text></g><line x1="2276" x2="2276" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="2386" y="46" width="116" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="2396" y="70" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="2396">NettyChannel</tspan></text></g><g class="actor"><rect x="2386" y="823.171875" width="116" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="2396" y="847.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="2396">NettyChannel</tspan></text></g><line x1="2444" x2="2444" y1="82" y2="823.171875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="signal"><text x="74" y="113" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="74">messageReceived</tspan></text><line x1="64" x2="204" y1="118" y2="118" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="240" y="149" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="240">received</tspan></text><line x1="204" x2="340" y1="154" y2="154" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="390" y="185" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="390">received</tspan></text><line x1="340" x2="504" y1="190" y2="190" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="562" y="221" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="562">received</tspan></text><line x1="504" x2="684" y1="226" y2="226" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="738" y="257" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="738">received</tspan></text><line x1="684" x2="856" y1="262" y2="262" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="938" y="293" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="938">run</tspan></text><line x1="856" x2="1044" y1="298" y2="298" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="703" y="318" width="306" height="45.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="708" y="337" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="708">默认线程池</tspan><tspan dy="1.2em" x="708">WrappedChannelHandler.SHARED_EXECUTOR</tspan></text></g><g class="signal"><text x="1098" y="394.1875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1098">received</tspan></text><line x1="1044" x2="1216" y1="399.1875" y2="399.1875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1272" y="430.1875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1272">received</tspan></text><line x1="1216" x2="1392" y1="435.1875" y2="435.1875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1490" y="466.1875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1490">reply</tspan></text><line x1="1392" x2="1628" y1="471.1875" y2="471.1875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1690" y="502.1875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1690">getInvoker</tspan></text><line x1="1628" x2="1832" y1="507.1875" y2="507.1875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="1699" y="527.1875" width="266" height="64.390625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1704" y="546.1875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1704">exporterMap中缓存了以</tspan><tspan dy="1.2em" x="1704">“test.dubbo.demo.ISayHi:20880”</tspan><tspan dy="1.2em" x="1704">-Exporter的映射关系</tspan></text></g><g class="signal"><text x="1810" y="622.578125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1810">invoke</tspan></text><line x1="1628" x2="2040" y1="627.578125" y2="627.578125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="1915" y="647.578125" width="250" height="83.59375" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1920" y="666.578125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1920">EchoFilter-ClassLoaderFilter</tspan><tspan dy="1.2em" x="1920">-GenericFilter-ContextFilter</tspan><tspan dy="1.2em" x="1920">-TraceFilter-TimeoutFilter</tspan><tspan dy="1.2em" x="1920">-MonitorFilter-ExceptionFilter</tspan></text></g><g class="signal"><text x="2134" y="762.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="2134">invoke</tspan></text><line x1="2040" x2="2276" y1="767.171875" y2="767.171875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="1902" y="798.171875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1902">send</tspan></text><line x1="1392" x2="2444" y1="803.171875" y2="803.171875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g></svg>